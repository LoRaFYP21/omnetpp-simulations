# End Node Distance Tracker

A specialized Python script for analyzing LoRa mesh network simulations with focus on real-time end node positioning and packet path tracking.

## Features

- **Fresh Coordinate Extraction**: Automatically finds and parses the latest .sca files for current end node positions
- **Real-Time Distance Calculation**: Computes distance between randomly placed end nodes for each simulation run
- **Packet Generation Tracking**: Counts total data packets generated by source node
- **Individual Path Analysis**: Traces the complete path each packet takes through the network
- **Delivery Statistics**: Tracks successful deliveries and calculates success rates
- **Comprehensive Transit Time Analysis**: Average, minimum, maximum transit times with detailed rankings

## Usage

### Basic Usage
```bash
# Run from simulations directory
python endnode_distance_tracker.py
```

### Advanced Options
```bash
# Specify custom paths.csv location
python endnode_distance_tracker.py --paths custom/paths.csv

# Use specific results directory
python endnode_distance_tracker.py --results-dir ../my_results

# Custom output filename
python endnode_distance_tracker.py --output my_analysis.txt

# Verbose output for debugging
python endnode_distance_tracker.py --verbose

# Full example
python endnode_distance_tracker.py --paths delivered_packets/paths.csv --results-dir ./results --output analysis_run1.txt --verbose
```

## Key Differences from Original Script

| Feature | Original Script | Distance Tracker |
|---------|-----------------|------------------|
| **Coordinate Source** | May use stale/cached data | Always uses latest .sca files |
| **Distance Accuracy** | Static coordinates | Fresh coordinates per run |
| **Path Detail** | Basic path statistics | Individual packet traces |
| **File Detection** | Fixed directory | Auto-finds latest results |
| **Progress Tracking** | Limited packet info | Complete generation→delivery flow |

## Sample Output

```
QUICK SUMMARY:
• End node distance: 3797.6 meters
  - Node 1000: (8200.0, 2570.0)  
  - Node 1001: (7198.0, 6233.0)
• Packets generated: 1
• Packets delivered: 1
• Delivery rate: 100.0%
• Average transit time: 2.483s
• Transit time range: 2.483s - 2.483s
```

## Report Sections

1. **Coordinate Extraction Status** - Shows which .sca files were processed and coordinate extraction success
2. **Packet Generation and Delivery Statistics** - Total counts and success rates  
3. **Individual Packet Path Analysis** - Complete trace for each packet including hop-by-hop progression
4. **Transit Time Statistics** - Detailed timing analysis with rankings
5. **Network Performance Summary** - Overall assessment and performance metrics

## Troubleshooting

### "No results directory with .sca files found!"
- Run a simulation first to generate result files
- Check that your simulation writes .sca files (scalar recording enabled)
- Use `--results-dir` to specify the correct location

### "Distance: Not available"  
- Simulation may not be recording position scalars
- End nodes might not have coordinate recording enabled
- Check that CordiX/CordiY or positionX/positionY are being logged

### Empty or incorrect paths
- Ensure `paths.csv` is being generated by your simulation
- Verify the path tracking is enabled in your OMNeT++ configuration
- Check that end node IDs are using the 1000/1001 offset

## Requirements

- Python 3.6+
- pandas
- Standard library modules (os, glob, math, argparse, datetime, pathlib)

Install dependencies:
```bash
pip install pandas
```

## Integration

This script complements the original analysis script by providing:
- Real-time coordinate tracking (vs. cached coordinates)
- Detailed packet-level analysis (vs. aggregate statistics)  
- Fresh result detection (vs. fixed paths)
- CLI flexibility (vs. hardcoded parameters)

Use this script when you need accurate distance measurements that change with each simulation run and detailed packet path analysis.