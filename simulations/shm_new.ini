[General]
# --------- Network / Map ----------
network = LoRaMesh
LoRaMesh.mapPath = "background/green"
LoRaMesh.mapWidth = 20000    # meters
LoRaMesh.mapHeight = 20000   # meters

# --------- Logging / Recording ----------
cmdenv-output-file = cmd_env_log.txt
cmdenv-autoflush = true
cmdenv-express-mode = true
**.vector-recording = true
**.scalar-recording = true
record-eventlog = true

# --------- RNG / Time ----------
rng-class = "cMersenneTwister"
seed-set = ${repetition}
simtime-resolution = -10
# sim-time-limit set per-config
warmup-period = 20s          # overridden if needed per-config

# --------- Energy model ----------
**.loRaNodes[*].LoRaNic.radio.energyConsumerType = "LoRaEnergyConsumer"
**.loRaNodes[*].**.energySourceModule = "IdealEpEnergyStorage"
**.loRaNodes[*].LoRaNic.radio.energyConsumer.configFile = xmldoc("energyConsumptionParameters.xml")
**.loRaEndNodes[*].LoRaNic.radio.energyConsumerType = "LoRaEnergyConsumer"
**.loRaEndNodes[*].**.energySourceModule = "IdealEpEnergyStorage"
**.loRaEndNodes[*].LoRaNic.radio.energyConsumer.configFile = xmldoc("energyConsumptionParameters.xml")

# --------- Area / Channel / Propagation ----------
**.constraintAreaMinX = 0m
**.constraintAreaMinY = 0m
**.constraintAreaMinZ = 0m
**.constraintAreaMaxX = 20000m
**.constraintAreaMaxY = 20000m
**.constraintAreaMaxZ = 0m
**.delayer.config = xmldoc("cloudDelays.xml")
**.radio.radioMediumModule = "LoRaMedium"
**.LoRaMedium.pathLossType = "LoRaLogNormalShadowing"
**.d0 = 356m
**.sigma = 0
**.K1 = 124.704
**.K2 = 44.7
**.minInterferenceTime = 0s
**.LoRaMedium.mediumLimitCacheType = "LoRaMediumCache"
**.LoRaMedium.rangeFilter = "communicationRange"
**.LoRaMedium.neighborCacheType = "LoRaNeighborCache"
**.LoRaMedium.neighborCache.range = 4000m
**.LoRaMedium.neighborCache.refillPeriod = 3000s

# --------- Gateways ----------
**.numberOfGateways = 0

# --------- App / Traffic Defaults (overridden per-config) ----------
**.sendPacketsContinuously = true
**.numberOfDestinationsPerNode = 1           # One end-to-end flow
**.dataPacketDefaultSize = 80B               # Overridden per-config
#**.packetTTL = 50
**.packetTTL = 300
**.loRaNodes[*].LoRaNodeApp.onlyNode0SendsPackets = true
**.loRaEndNodes[*].LoRaNodeApp.onlyNode0SendsPackets = true
**.timeToNextDataPacketDist = "constant"
# DO NOT set Avg when Dist=constant
# **.timeToNextDataPacketAvg = 1h   # (left commented out to avoid conflicts)

# First packet times (overridden per-config)
**.loRaNodes[*].LoRaNodeApp.timeToFirstDataPacket = 10s
#**.loRaEndNodes[*].LoRaNodeApp.timeToFirstDataPacket = 10s
**.loRaEndNodes[*].LoRaNodeApp.timeToFirstDataPacket = 60s  # routing warm-up


# --------- Forwarding / Routing ----------
**.numberOfPacketsToForward = 0              # 0 = no limit
**.ownDataPriority = 0                       # forward first
**.loRaNodes[*].LoRaNodeApp.routingMetric = 2
**.loRaEndNodes[*].LoRaNodeApp.routingMetric = 0
**.routeDiscovery = true
**.routeTimeout = 300s
**.storeBestRouteOnly = false
**.getRoutesFromDataPackets = true
**.routingPacketPriority = 0.5
**.routingPacketMaxSize = 12B
**.timeToFirstRoutingPacket = 30s+uniform(0s, 5s)
**.timeToNextRoutingPacketDist = "uniform"
**.timeToNextRoutingPacketMin = 0s
**.timeToNextRoutingPacketMax = 120s
**.timeToNextRoutingPacketAvg = 60s

# --------- Duty Cycle (overridden per-config) ----------
**.dutyCycle = 0.01
**.enforceDutyCycle = true

# --------- LoRa PHY Defaults (overridden per-config) ----------
**.loRaNodes[*].**.initFromDisplayString = false
**.loRaNodes[*].**initialLoRaSF = 8
**.loRaNodes[*].**minLoRaSF = 7
**.loRaNodes[*].**maxLoRaSF = 12
**.loRaNodes[*].**initialLoRaBW = 125 kHz
**.loRaNodes[*].**initialLoRaCR = 1
**.loRaNodes[*].**initialLoRaTP = 19dBm
**.loRaNodes[*].**initialLoRaCAD = true
**.loRaNodes[*].**initialLoRaCADatt = 0dB

**.loRaEndNodes[*].**.initFromDisplayString = false
**.loRaEndNodes[*].**initialLoRaSF = 8
**.loRaEndNodes[*].**minLoRaSF = 7
**.loRaEndNodes[*].**maxLoRaSF = 12
**.loRaEndNodes[*].**initialLoRaBW = 125 kHz
**.loRaEndNodes[*].**initialLoRaCR = 1
**.loRaEndNodes[*].**initialLoRaTP = 20dBm
**.loRaEndNodes[*].**initialLoRaCAD = true
**.loRaEndNodes[*].**initialLoRaCADatt = 0dB

# --------- Placement Bounds ----------
**.loRaNodes[*].minX = 0m
**.loRaNodes[*].minY = 0m
**.loRaNodes[*].maxX = 2000m
**.loRaNodes[*].maxY = 2000m
**.loRaEndNodes[*].minX = 0m
**.loRaEndNodes[*].minY = 0m
**.loRaEndNodes[*].maxX = 4000m
**.loRaEndNodes[*].maxY = 4000m

[Config Mesh_FeatureMode_100PDR]
description = "Guaranteed PDR: small packets, relaxed interval, no collisions"

# --- Topology (same chain)
**.numberOfNodes = 2
**.numberOfEndNodes = 2
**.loRaEndNodes[0].initialX = 500m
**.loRaEndNodes[0].initialY = 7500m
**.loRaNodes[0].initialX    = 2430m
**.loRaNodes[0].initialY    = 7500m
**.loRaNodes[1].initialX    = 4365m
**.loRaNodes[1].initialY    = 7500m
**.loRaEndNodes[1].initialX = 6300m
**.loRaEndNodes[1].initialY = 7500m

# Make the app generate 200 B packets (not 800 B)
**.dataPacketDefaultSize = 2000B

**.timeToNextDataPacketMin = 30s
**.timeToNextDataPacketMax = 30s

# PHY (orthogonal SFs to avoid collisions)
**.loRaNodes[*].**initialLoRaSF = 7
**.loRaEndNodes[*].**initialLoRaSF = 8
**.loRaNodes[*].**initialLoRaBW = 125 kHz
**.loRaEndNodes[*].**initialLoRaBW = 125 kHz

# Duty cycle OFF for guaranteed delivery
**.dutyCycle = 1.0
**.enforceDutyCycle = false

sim-time-limit = 3600s
warmup-period = 20s
